# ğŸ“Œ LangChain æ™ºèƒ½ä½“å¼€å‘é€ŸæŸ¥è¡¨

## 1. åŸºç¡€æ ¸å¿ƒæ¦‚å¿µ

- **PromptTemplate**ï¼šæç¤ºè¯æ¨¡æ¿ï¼Œå®šä¹‰è¾“å…¥ â†’ è¾“å‡ºæ ¼å¼ã€‚
- **LLM / ChatModel**ï¼šç»Ÿä¸€æ¥å£å°è£…ä¸åŒå¤§æ¨¡å‹ï¼ˆOpenAIã€Qwenã€Baichuanã€DeepSeek ç­‰ï¼‰ã€‚
- **OutputParser**ï¼šæŠŠ LLM è¾“å‡ºç»“æœè½¬æˆç»“æ„åŒ–æ•°æ®ï¼ˆJSONã€å¯¹è±¡ç­‰ï¼‰ã€‚

------

## 2. é“¾ï¼ˆChainsï¼‰

- **LLMChain**ï¼šæœ€åŸºç¡€é“¾ï¼ˆPrompt â†’ Model â†’ Outputï¼‰ã€‚
- **SequentialChain**ï¼šå¤šä¸ªæ­¥éª¤ä¾æ¬¡æ‰§è¡Œã€‚
- **ConversationChain**ï¼šå¸¦è®°å¿†çš„å¯¹è¯ã€‚

ğŸ‘‰ å¸¸è§é¢è¯•é¢˜ï¼š
 **Q:** ä¸ºä»€ä¹ˆéœ€è¦ Chainï¼Ÿ
 **A:** å› ä¸º LLM æœ¬èº«æ˜¯é»‘ç›’ï¼Œ`é€šè¿‡ Chain å¯ä»¥ç»„åˆä¸åŒæ¨¡å—ï¼ˆLLMã€å·¥å…·ã€è®°å¿†ï¼‰ï¼Œå®ç°å¤æ‚æµç¨‹çš„å°è£…å’Œå¤ç”¨ã€‚

------

## 3. è®°å¿†ï¼ˆMemoryï¼‰

- `ConversationBufferMemory`ï¼šä¿å­˜æ‰€æœ‰å¯¹è¯è®°å½•ã€‚
- `ConversationBufferWindowMemory`ï¼šåªä¿å­˜æœ€è¿‘ k è½®å¯¹è¯ã€‚
- `VectorStoreRetrieverMemory`ï¼šåŸºäºå‘é‡æ£€ç´¢çš„è®°å¿†ï¼ˆé€‚åˆé•¿ä¸Šä¸‹æ–‡ï¼‰ã€‚

ğŸ‘‰ å¸¸è§é¢è¯•é¢˜ï¼š
 **Q:** Memory å’Œ RAG æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
 **A:** Memory åå‘äºçŸ­æœŸå¯¹è¯ä¸Šä¸‹æ–‡å­˜å‚¨ï¼Œè€Œ RAG æ˜¯ä»å¤–éƒ¨çŸ¥è¯†åº“æ£€ç´¢ä¿¡æ¯ã€‚å‰è€…è§£å†³å¯¹è¯è¿è´¯æ€§ï¼Œåè€…è§£å†³çŸ¥è¯†è¦†ç›–ä¸è¶³ã€‚

------

## 4. RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰

- **æ­¥éª¤ï¼š** æ–‡æœ¬åŠ è½½ â†’ åˆ‡åˆ† â†’ å‘é‡åŒ– â†’ å­˜å…¥å‘é‡åº“ â†’ æ£€ç´¢ â†’ æ‹¼æ¥ä¸Šä¸‹æ–‡ â†’ äº¤ç»™æ¨¡å‹å›ç­”ã€‚
- **ç›¸å…³æ¨¡å—ï¼š**
  - `DocumentLoaders`ï¼ˆPDFã€ç½‘é¡µç­‰ï¼‰
  - `TextSplitter`ï¼ˆRecursiveCharacterTextSplitter ç­‰ï¼‰
  - `VectorStore`ï¼ˆFAISSã€Pineconeã€Milvusâ€¦ï¼‰
  - `RetrievalQA`ï¼ˆLangChain å°è£…å¥½çš„ QA Pipelineï¼‰

ğŸ‘‰ å¸¸è§é¢è¯•é¢˜ï¼š
 **Q:** RAG ä¸ºä»€ä¹ˆæ¯”å•çº¯è°ƒç”¨ LLM æ›´å¯é ï¼Ÿ
 **A:** å› ä¸ºå®ƒæŠŠçŸ¥è¯†é™åˆ¶åœ¨ç‰¹å®šè¯­æ–™é‡Œï¼Œå‡å°‘æ¨¡å‹å¹»è§‰ï¼ˆhallucinationï¼‰ï¼Œè¿˜èƒ½æ›´æ–°å¤–éƒ¨çŸ¥è¯†è€Œä¸ä¾èµ–æ¨¡å‹é‡æ–°è®­ç»ƒã€‚

------

## 5. å·¥å…·è°ƒç”¨ï¼ˆTool Use / Function Callingï¼‰

- **Tools**ï¼šå°è£…å¤–éƒ¨ APIï¼ˆæœç´¢ã€æ•°æ®åº“ã€å¤©æ°”æŸ¥è¯¢â€¦ï¼‰ã€‚
- **Function Calling**ï¼šéƒ¨åˆ†æ¨¡å‹ï¼ˆå¦‚ OpenAI GPTã€Qwenï¼‰æ”¯æŒå‡½æ•°è°ƒç”¨æ¨¡å¼ï¼Œèƒ½ç›´æ¥è¾“å‡ºç»“æ„åŒ–å‚æ•°è°ƒç”¨ APIã€‚

ğŸ‘‰ å¸¸è§é¢è¯•é¢˜ï¼š
 **Q:** å¦‚ä½•åœ¨ LangChain é‡Œæ¥å…¥ä¸€ä¸ªå¤–éƒ¨ APIï¼Ÿ
 **A:** ç”¨ `Tool` å°è£… APIï¼ŒæŒ‡å®š `name`ã€`description` å’Œ `func`ï¼Œå†æŠŠ Tool äº¤ç»™ Agent è°ƒåº¦ã€‚

------

## 6. æ™ºèƒ½ä½“ï¼ˆAgentï¼‰

- **AgentExecutor**ï¼šè¿è¡Œæ™ºèƒ½ä½“ã€‚
- **å¸¸è§ç±»å‹ï¼š**
  - ReAct Agentï¼ˆæ¨ç† + è¡ŒåŠ¨å¾ªç¯ï¼‰
  - Conversational Agentï¼ˆå¤šè½®å¯¹è¯ï¼‰
  - Plan & Executeï¼ˆå…ˆè§„åˆ’ï¼Œå†æ‰§è¡Œï¼‰
- **LangGraph**ï¼šLangChain æ–°æ¨¡å—ï¼Œæ”¯æŒæ›´å¤æ‚çš„å¤š Agent åä½œå’Œæµç¨‹ç¼–æ’ã€‚

ğŸ‘‰ å¸¸è§é¢è¯•é¢˜ï¼š
 **Q:** Agent å’Œ Chain çš„åŒºåˆ«ï¼Ÿ
 **A:** Chain æ˜¯å›ºå®šæµç¨‹ï¼ŒAgent æ˜¯åŠ¨æ€å†³ç­–ã€‚Chain é€‚åˆç¡®å®šæ­¥éª¤çš„ä»»åŠ¡ï¼ŒAgent é€‚åˆéœ€è¦æ¨¡å‹è‡ªä¸»é€‰æ‹©å·¥å…·æˆ–è§„åˆ’æ­¥éª¤çš„ä»»åŠ¡ã€‚

------

## 7. Prompt å·¥ç¨‹

- **æŠ€å·§ï¼š**
  - Few-shot Promptï¼ˆç»™å‡ ä¸ªç¤ºä¾‹ï¼‰
  - Chain-of-thoughtï¼ˆå¼•å¯¼æ¨¡å‹é€æ­¥æ¨ç†ï¼‰
  - ReAct Promptï¼ˆæ¨ç† + è¡ŒåŠ¨ï¼‰
  - è¾“å‡ºæ ¼å¼çº¦æŸï¼ˆJSON schema ç­‰ï¼‰

ğŸ‘‰ å¸¸è§é¢è¯•é¢˜ï¼š
 **Q:** å¦‚ä½•å‡å°‘æ¨¡å‹è¾“å‡ºæ ¼å¼æ··ä¹±çš„é—®é¢˜ï¼Ÿ
 **A:** å¯ä»¥åœ¨ Prompt ä¸­æ˜ç¡®è¦æ±‚è¾“å‡º JSONï¼Œé…åˆ `OutputParser` è§£æï¼›å¦‚æœæ¨¡å‹æ”¯æŒ Function Callingï¼Œå¯ä»¥ç›´æ¥ç”¨ç»“æ„åŒ–è°ƒç”¨ã€‚

------

## 8. ç³»ç»Ÿä¸ä¼˜åŒ–

- **æ€§èƒ½ä¼˜åŒ–**ï¼šç¼“å­˜ï¼ˆLangChain Cacheï¼‰ã€æ‰¹å¤„ç†ã€å¼‚æ­¥è°ƒç”¨ã€‚
- **æˆæœ¬ä¼˜åŒ–**ï¼šå‡å°‘ä¸Šä¸‹æ–‡é•¿åº¦ã€ä½¿ç”¨ Embedding æ£€ç´¢æ›¿ä»£å¤§æ¨¡å‹è°ƒç”¨ã€‚
- **å®‰å…¨æ€§**ï¼šPrompt æ³¨å…¥é˜²æŠ¤ã€å·¥å…·è°ƒç”¨å®‰å…¨æ ¡éªŒã€æƒé™ç®¡ç†ã€‚

------

# ğŸ¯ é¢è¯•ç­”é¢˜å°æŠ€å·§

1. **æ¡†æ¶å¯¹æ¯”**
   - LangChainï¼šæ¨¡å—ä¸°å¯Œï¼Œç”Ÿæ€å¤§ï¼Œä½†ç¨æ˜¾é‡é‡ã€‚
   - LlamaIndexï¼šä¸“æ³¨äº RAG å’Œæ–‡æ¡£é—®ç­”ï¼Œç®€å•è½»é‡ã€‚
   - Haystackï¼šä¼ä¸šçº§ï¼Œå NLP pipelineã€‚
2. **ç¤ºä¾‹é¡¹ç›®**ï¼ˆæœ€å¥½å‡†å¤‡ä¸€ä¸ª demoï¼‰
   - åœºæ™¯ï¼šä¸Šä¼  PDF æ–‡æ¡£ï¼Œç”¨æˆ·æé—® â†’ ç³»ç»Ÿæ£€ç´¢ç›¸å…³å†…å®¹ â†’ å¤§æ¨¡å‹æ€»ç»“å›ç­”ã€‚
   - åŠ åˆ†é¡¹ï¼šèƒ½è¯´è‡ªå·±å®ç°è¿‡ **RAG + å·¥å…·è°ƒç”¨**ï¼ˆæ¯”å¦‚è¿˜èƒ½æŸ¥å®æ—¶å¤©æ°”/æ•°æ®åº“ï¼‰ã€‚



------

# ğŸ“Œ LangChain æ™ºèƒ½ä½“ï¼ˆAgentï¼‰è¶…è¯¦ç»†é€ŸæŸ¥è¡¨

## 1. ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“ï¼ˆAgentï¼‰

- **å®šä¹‰**ï¼šä¸€ç§åŸºäºå¤§æ¨¡å‹ï¼ˆLLMï¼‰çš„ä»»åŠ¡æ‰§è¡Œæ¡†æ¶ï¼Œæ¨¡å‹ä¸ä»…ç”Ÿæˆå›ç­”ï¼Œè¿˜èƒ½ **è°ƒç”¨å·¥å…·ã€è®°å¿†ã€è§„åˆ’æ­¥éª¤**ï¼Œè§£å†³å¤æ‚ä»»åŠ¡ã€‚
- **å…³é”®ç‚¹**ï¼šChain æ˜¯å›ºå®šæµç¨‹ï¼Œè€Œ Agent æ˜¯**åŠ¨æ€å†³ç­–**ï¼Œä¼šæ ¹æ®è¾“å…¥å†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·ã€æ‰§è¡Œå¤šå°‘æ¬¡å¾ªç¯ã€‚

ğŸ‘‰ é¢è¯•ç­”æ³•ï¼š

> â€œAgent çš„æ ¸å¿ƒå°±æ˜¯æŠŠ LLM å½“ä½œæ¨ç†å¼•æ“ï¼Œå®ƒèƒ½ç»“åˆå·¥å…·ã€è®°å¿†ã€ç¯å¢ƒï¼ŒåŠ¨æ€å®Œæˆå¤æ‚ä»»åŠ¡ï¼Œè€Œä¸ä»…æ˜¯ç®€å•çš„æ–‡æœ¬ç”Ÿæˆã€‚â€

------

## 2. LangChain ä¸­ Agent çš„ç»„æˆéƒ¨åˆ†

1. **LLM**ï¼šæ¨ç†æ ¸å¿ƒã€‚
2. **Tools**ï¼šå¤–éƒ¨èƒ½åŠ›ï¼ˆAPIã€æ•°æ®åº“ã€Python æ‰§è¡Œå™¨ç­‰ï¼‰ã€‚
3. **Memory**ï¼šå­˜å‚¨ä¸Šä¸‹æ–‡ï¼ˆå¯¹è¯å†å²ã€å‘é‡çŸ¥è¯†åº“ï¼‰ã€‚
4. **Agent Executor**ï¼šè´Ÿè´£è¿è¡Œå¾ªç¯ï¼ˆReason â†’ Act â†’ Observeï¼‰ã€‚

ğŸ‘‰ é¢è¯•ç­”æ³•ï¼š

> â€œLangChain çš„ Agent å°±åƒä¸€ä¸ªæ‰§è¡Œå™¨ï¼šè¾“å…¥é—®é¢˜ â†’ LLM å†³ç­– â†’ è°ƒç”¨å·¥å…· â†’ è§‚å¯Ÿç»“æœ â†’ ç»§ç»­å†³ç­– â†’ æœ€ç»ˆè¾“å‡ºç­”æ¡ˆã€‚â€

------

## 3. Agent çš„ç±»å‹

LangChain æä¾›äº†ä¸åŒç§ç±»çš„æ™ºèƒ½ä½“ï¼Œå¸¸è§æœ‰ï¼š

1. **ZeroShotAgent**
   - ä¸éœ€è¦ç¤ºä¾‹ï¼Œç›´æ¥åŸºäºå·¥å…·æè¿°æ¥è°ƒç”¨ã€‚
   - ä½¿ç”¨åœºæ™¯ï¼šè¾“å…¥æ˜ç¡®ã€å·¥å…·æè¿°æ¸…æ™°çš„æƒ…å†µã€‚
2. **ConversationalAgent**
   - ç»“åˆå¯¹è¯å†å²ï¼Œé€‚åˆå¤šè½®äº¤äº’ã€‚
   - ä½¿ç”¨åœºæ™¯ï¼šæ™ºèƒ½å®¢æœã€åŠ©æ‰‹ç±»åº”ç”¨ã€‚
3. **ReAct Agent**
   - ç»å…¸æ¨¡å¼ï¼š**æ¨ç†ï¼ˆReasoningï¼‰+ è¡ŒåŠ¨ï¼ˆActionï¼‰+ è§‚å¯Ÿï¼ˆObservationï¼‰**
   - å¾ªç¯æ‰§è¡Œç›´åˆ°å¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚
   - ä½¿ç”¨åœºæ™¯ï¼šå¤æ‚ä»»åŠ¡æ‹†è§£ã€æœç´¢é—®ç­”ã€‚
4. **Plan and Execute Agent**
   - ä¸¤æ­¥èµ°ï¼šå…ˆç”¨ LLM ç”Ÿæˆè®¡åˆ’ï¼ˆPlanï¼‰ï¼Œå†æ‰§è¡Œï¼ˆExecuteï¼‰ã€‚
   - ä½¿ç”¨åœºæ™¯ï¼šä»»åŠ¡è¾ƒé•¿ã€éœ€è¦æ­¥éª¤è§„åˆ’çš„æƒ…å†µï¼ˆæ¯”å¦‚æ—…è¡Œè§„åˆ’ï¼‰ã€‚
5. **Custom Agentï¼ˆè‡ªå®šä¹‰æ™ºèƒ½ä½“ï¼‰**
   - åŸºäº `AgentExecutor` è‡ªå·±å®ç°ã€‚
   - ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦é«˜åº¦å®šåˆ¶çš„ä¸šåŠ¡æµç¨‹ã€‚

------

## 4. Toolsï¼ˆå·¥å…·ï¼‰

- **å®šä¹‰**ï¼šä¸€ä¸ªå‡½æ•°æ¥å£ï¼ŒLLM å¯ä»¥è°ƒç”¨å®ƒå®Œæˆç‰¹å®šä»»åŠ¡ã€‚
- **å†…ç½®å·¥å…·ç¤ºä¾‹**ï¼š
  - `SerpAPI`ï¼ˆæœç´¢ï¼‰
  - `SQLDatabase`ï¼ˆæ•°æ®åº“æŸ¥è¯¢ï¼‰
  - `PythonREPL`ï¼ˆè¿è¡Œ Python ä»£ç ï¼‰
  - `VectorStore`ï¼ˆçŸ¥è¯†æ£€ç´¢ï¼‰

ğŸ‘‰ é¢è¯•ç­”æ³•ï¼š

> â€œåœ¨ LangChain ä¸­ï¼Œå·¥å…·æ˜¯ Agent çš„æ‰‹è‡‚ã€‚LLM æœ¬èº«ä¸ä¼šç®—ï¼Œä½†é€šè¿‡ Toolsï¼Œå®ƒèƒ½æŸ¥æ•°æ®åº“ã€è°ƒ APIã€è¿è¡Œä»£ç ï¼Œä»è€Œè§£å†³æ›´å¤æ‚çš„é—®é¢˜ã€‚â€

------

## 5. Agent å·¥ä½œæµ

å…¸å‹æ‰§è¡Œå¾ªç¯ï¼ˆReAct æ€è·¯ï¼‰ï¼š

1. ç”¨æˆ·è¾“å…¥é—®é¢˜ã€‚
2. LLM åˆ†æ â†’ ç”Ÿæˆæ¨ç†æ­¥éª¤ï¼ˆReasoningï¼‰ã€‚
3. é€‰æ‹©å·¥å…·ï¼ˆActionï¼‰ã€‚
4. æ‰§è¡Œå·¥å…· â†’ å¾—åˆ°ç»“æœï¼ˆObservationï¼‰ã€‚
5. LLM æ ¹æ®ç»“æœç»§ç»­æ¨ç†ã€‚
6. æœ€ç»ˆç”Ÿæˆç­”æ¡ˆï¼ˆFinal Answerï¼‰ã€‚

ğŸ‘‰ é¢è¯•ç­”æ³•ï¼š

> â€œAgent çš„æœ¬è´¨å°±æ˜¯ä¸æ–­å¾ªç¯ ReActï¼šReason â†’ Act â†’ Observeï¼Œç›´åˆ°å¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚â€

------

## 6. è®°å¿†ï¼ˆMemoryï¼‰

- **ConversationBufferMemory**ï¼šä¿å­˜å…¨éƒ¨å¯¹è¯å†å²ã€‚
- **ConversationBufferWindowMemory**ï¼šåªä¿å­˜æœ€è¿‘ k è½®ã€‚
- **ConversationKGMemory**ï¼šçŸ¥è¯†å›¾è°±å½¢å¼çš„è®°å¿†ã€‚
- **VectorStoreRetrieverMemory**ï¼šç»“åˆå‘é‡æ£€ç´¢çš„é•¿æœŸè®°å¿†ã€‚

ğŸ‘‰ é¢è¯•ç­”æ³•ï¼š

> â€œMemory è®© Agent ä¿æŒçŠ¶æ€ï¼Œé¿å…æ¯æ¬¡ä»é›¶å¼€å§‹ã€‚æ¯”å¦‚å®¢æˆ·å’¨è¯¢å¤šè½®é—®é¢˜æ—¶ï¼ŒAgent èƒ½è®°ä½ä¹‹å‰çš„ä¸Šä¸‹æ–‡ã€‚â€

------

## 7. é«˜çº§åŠŸèƒ½

1. **å¤š Agent åä½œ**
   - å¤šä¸ª Agent åˆ†å·¥åˆä½œï¼ˆæ¯”å¦‚ä¸€ä¸ªåšè§„åˆ’ï¼Œä¸€ä¸ªæ‰§è¡Œï¼‰ã€‚
   - LangChain çš„æ–°æ¨¡å— **LangGraph** ä¸“é—¨æ”¯æŒè¿™ä¸€ç‚¹ã€‚
2. **è¾“å‡ºæ§åˆ¶**
   - é€šè¿‡ `OutputParser` ä¿è¯è¾“å‡ºæ ¼å¼ï¼ˆJSONã€ç»“æ„åŒ–æ•°æ®ï¼‰ã€‚
3. **å®‰å…¨ä¸é˜²æŠ¤**
   - é˜²æ­¢ Prompt æ³¨å…¥ï¼ˆé™åˆ¶å·¥å…·è°ƒç”¨èŒƒå›´ï¼‰ã€‚
   - å¯¹å·¥å…·è°ƒç”¨ç»“æœåšæ ¡éªŒã€‚

------

## 8. å¸¸è§é¢è¯•é—®é¢˜ä¸å‚è€ƒå›ç­”

**Q1:** Agent å’Œ Chain çš„åŒºåˆ«ï¼Ÿ
 ğŸ‘‰ Aï¼šChain æ˜¯å›ºå®šæµç¨‹ï¼Œé€‚åˆç»“æ„åŒ–ä»»åŠ¡ï¼›Agent æ˜¯åŠ¨æ€å†³ç­–ï¼Œèƒ½æ ¹æ®è¾“å…¥å’Œä¸Šä¸‹æ–‡çµæ´»é€‰æ‹©å·¥å…·å’Œæ­¥éª¤ã€‚

**Q2:** è¯´ä¸€ä¸‹ ReAct Agent çš„æ‰§è¡Œé€»è¾‘ï¼Ÿ
 ğŸ‘‰ Aï¼šReAct = Reasoning + Actingã€‚æ¨¡å‹ä¼šå…ˆæ¨ç†ï¼Œå†é€‰æ‹©å·¥å…·æ‰§è¡Œï¼Œè§‚å¯Ÿç»“æœåç»§ç»­æ¨ç†ï¼Œå½¢æˆä¸€ä¸ªå¾ªç¯ï¼Œç›´åˆ°å¾—åˆ°ç­”æ¡ˆã€‚

**Q3:** å¦‚ä½•åœ¨ LangChain ä¸­å®ç°å·¥å…·è°ƒç”¨ï¼Ÿ
 ğŸ‘‰ Aï¼šå®šä¹‰ä¸€ä¸ª Toolï¼ˆåŒ…å« nameã€descriptionã€funcï¼‰ï¼ŒæŠŠå®ƒäº¤ç»™ AgentExecutorï¼ŒLLM å°±èƒ½æŒ‰éœ€è°ƒç”¨å®ƒã€‚

**Q4:** å¦‚æœæ¨¡å‹è¾“å‡ºæ ¼å¼æ··ä¹±ï¼Œæ€ä¹ˆå¤„ç†ï¼Ÿ
 ğŸ‘‰ Aï¼šå¯ä»¥åœ¨ Prompt ä¸­åŠ æ ¼å¼çº¦æŸï¼Œç”¨ `OutputParser` è§£æï¼›æ›´å¥½çš„æ–¹å¼æ˜¯ç”¨æ”¯æŒ Function Calling çš„æ¨¡å‹ï¼ˆå¦‚ OpenAIã€Qwenï¼‰ã€‚

**Q5:** åœ¨ä¼ä¸šçº§åœºæ™¯é‡Œï¼Œæ€ä¹ˆä¿è¯ Agent çš„ç¨³å®šæ€§ï¼Ÿ
 ğŸ‘‰ Aï¼šå¯ä»¥åšä¸‰ç‚¹ï¼š

1. å·¥å…·è°ƒç”¨åšæƒé™ä¸å®‰å…¨æ ¡éªŒï¼›
2. å¯¹ LLM è¾“å‡ºåšæ ¼å¼çº¦æŸï¼›
3. åŠ ç¼“å­˜ä¸æ—¥å¿—ç›‘æ§ï¼Œæå‡æ€§èƒ½å’Œå¯è¿½è¸ªæ€§ã€‚

------

## 9. ä½ å¯ä»¥èƒŒçš„æ€»ç»“æ€§è¯­å¥

- â€œLangChain çš„ Agent å°±æ˜¯è®©å¤§æ¨¡å‹ä¸åªæ˜¯å›ç­”é—®é¢˜ï¼Œè¿˜èƒ½è°ƒç”¨å·¥å…·ã€å­˜å‚¨è®°å¿†ã€åŠ¨æ€è§„åˆ’ä»»åŠ¡ã€‚â€
- â€œå¸¸è§ Agent ç±»å‹æœ‰ ZeroShotã€Conversationalã€ReActã€Plan & Executeï¼Œå…¶ä¸­ ReAct æ˜¯æœ€ç»å…¸çš„æ¨¡å¼ã€‚â€
- â€œAgent çš„å·¥ä½œæµæ˜¯ ReActï¼šReason â†’ Act â†’ Observe â†’ Final Answerã€‚â€
- â€œ**Memory è§£å†³ä¸Šä¸‹æ–‡è¿è´¯æ€§ï¼ŒRAG è§£å†³çŸ¥è¯†è¦†ç›–é—®é¢˜**ï¼Œä¸¤è€…å¯ä»¥ç»“åˆä½¿ç”¨ã€‚â€
- â€œåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä¼šç”¨ **LangChain çš„ AgentExecutor + Tools + Memoryï¼Œæ¥æ„å»ºä¸€ä¸ªä¼ä¸šçº§æ™ºèƒ½ä½“ç³»ç»Ÿã€‚**â€





---





# ğŸ“Œ LangChain Agent å¼€å‘è¯¦è§£ï¼ˆå¸¦ä»£ç ï¼‰

## 1. Agent å¼€å‘çš„æ ¸å¿ƒè¦ç´ 
1. **LLM** â†’ å†³ç­–ä¸æ¨ç†  
2. **Tools** â†’ å·¥å…·è°ƒç”¨ï¼ˆæœç´¢ã€æ•°æ®åº“ã€è®¡ç®—å™¨ç­‰ï¼‰  
3. **Memory** â†’ ä¸Šä¸‹æ–‡è®°å¿†  
4. **Agent Executor** â†’ æ™ºèƒ½ä½“æ‰§è¡Œå™¨  

ğŸ‘‰ é¢è¯•æ—¶è¦å¼ºè°ƒï¼š**Agent = LLM + Tools + Memory + æ‰§è¡Œå¾ªç¯**  

---

## 2. å®šä¹‰å·¥å…·ï¼ˆToolsï¼‰
åœ¨ LangChain é‡Œï¼Œå·¥å…·å°±æ˜¯ä¸€ä¸ªå‡½æ•° + æè¿°ï¼ŒAgent ä¼šé€‰æ‹©åˆé€‚çš„å·¥å…·æ¥è°ƒç”¨ã€‚  

```python
from langchain.agents import Tool

# å®šä¹‰ä¸€ä¸ªç®€å•å·¥å…·ï¼šæ•°å­¦è®¡ç®—
def multiply(a: int, b: int) -> int:
    return a * b

multiply_tool = Tool(
    name="Multiply",
    func=lambda x: multiply(*map(int, x.split(","))),
    description="ç”¨æ¥è®¡ç®—ä¸¤ä¸ªæ•°å­—çš„ä¹˜ç§¯ï¼Œè¾“å…¥æ ¼å¼ä¸º 'a,b'"
)
```

ğŸ‘‰ **è¦ç‚¹**ï¼š  
- æ¯ä¸ªå·¥å…·éƒ½éœ€è¦ `name`ã€`func`ã€`description`ã€‚  
- LLM æ ¹æ®æè¿°æ¥é€‰æ‹©å·¥å…·ã€‚  

---

## 3. åˆ›å»ºä¸€ä¸ª ReAct Agent
ReAct æ¨¡å¼ï¼ˆReasoning + Acting + Observingï¼‰æ˜¯ **æœ€å¸¸è§çš„æ™ºèƒ½ä½“æ¨¡å¼**ã€‚

```python
from langchain_openai import OpenAI
from langchain.agents import initialize_agent, AgentType

# åŠ è½½å¤§æ¨¡å‹
llm = OpenAI(temperature=0)

# å®šä¹‰å·¥å…·åˆ—è¡¨
tools = [multiply_tool]

# åˆå§‹åŒ–æ™ºèƒ½ä½“
agent = initialize_agent(
    tools=tools,
    llm=llm,
    agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,  # ReActæ¨¡å¼
    verbose=True
)

# è¿è¡Œ
result = agent.run("è®¡ç®— 23 å’Œ 7 çš„ä¹˜ç§¯")
print(result)
```

ğŸ‘‰ **æµç¨‹**ï¼š  
1. ç”¨æˆ·æé—®  
2. LLM ç”Ÿæˆ Reasoning â†’ é€‰æ‹©å·¥å…· Multiply  
3. æ‰§è¡Œ Multiply(23,7) â†’ 161  
4. è¾“å‡º Final Answer  

---

## 4. Conversational Agentï¼ˆå¸¦è®°å¿†çš„å¯¹è¯æ™ºèƒ½ä½“ï¼‰
```python
from langchain.memory import ConversationBufferMemory

# å®šä¹‰è®°å¿†
memory = ConversationBufferMemory(memory_key="chat_history")

agent_with_memory = initialize_agent(
    tools=tools,
    llm=llm,
    agent=AgentType.CONVERSATIONAL_REACT_DESCRIPTION,  # å¯¹è¯Agent
    memory=memory,
    verbose=True
)

# å¤šè½®å¯¹è¯
print(agent_with_memory.run("æˆ‘æœ‰ 12 ä¸ªè‹¹æœ"))
print(agent_with_memory.run("æˆ‘å†ä¹° 8 ä¸ªï¼Œç°åœ¨ä¸€å…±æœ‰å¤šå°‘ï¼Ÿ"))
```

ğŸ‘‰ **è¦ç‚¹**ï¼š  
- ConversationAgent ç»“åˆ Memoryï¼Œå¯ä»¥è¿½è¸ªä¸Šä¸‹æ–‡ã€‚  
- é¢è¯•æ—¶å¯ä»¥è¯´ï¼š**Memory è§£å†³äº†å¯¹è¯è¿è´¯æ€§é—®é¢˜ã€‚**  

---

## 5. Plan and Execute Agentï¼ˆè§„åˆ’ + æ‰§è¡Œï¼‰
é€‚åˆä»»åŠ¡è¾ƒé•¿ã€éœ€è¦å¤šä¸ªæ­¥éª¤çš„æƒ…å†µã€‚

```python
from langchain.agents import load_tools
from langchain.agents import AgentExecutor, create_openai_functions_agent
from langchain.prompts import ChatPromptTemplate

# åŠ è½½å·¥å…·
tools = load_tools(["serpapi", "llm-math"], llm=llm)

# Prompt æ¨¡æ¿
prompt = ChatPromptTemplate.from_messages([
    ("system", "ä½ æ˜¯ä¸€ä¸ªä¼šè§„åˆ’ä»»åŠ¡çš„åŠ©æ‰‹"),
    ("user", "{input}")
])

# å®šä¹‰æ™ºèƒ½ä½“
agent = create_openai_functions_agent(llm, tools, prompt)
agent_executor = AgentExecutor(agent=agent, tools=tools, verbose=True)

# è¿è¡Œ
agent_executor.invoke({"input": "å¸®æˆ‘æŸ¥ä¸€ä¸‹åŒ—äº¬ä»Šå¤©çš„å¤©æ°”ï¼Œå¹¶è®¡ç®—æ¯”ä¸Šæµ·æ¸©åº¦é«˜å¤šå°‘åº¦"})
```

ğŸ‘‰ **è¦ç‚¹**ï¼š  
- Plan é˜¶æ®µï¼šLLM æ‹†è§£ä»»åŠ¡ â†’ æŸ¥å¤©æ°” + æ•°å­¦è®¡ç®—  
- Execute é˜¶æ®µï¼šä¾æ¬¡è°ƒç”¨å·¥å…·å®Œæˆä»»åŠ¡  

---

## 6. å¤š Agent åä½œï¼ˆLangGraphï¼‰
æœ€æ–°è¶‹åŠ¿æ˜¯ **å¤šæ™ºèƒ½ä½“åä½œ**ï¼ŒLangChain æ¨å‡ºäº† **LangGraph**ï¼Œå¯ä»¥è®©å¤šä¸ª Agent ååŒè§£å†³å¤æ‚ä»»åŠ¡ã€‚  

```python
# ç¤ºä¾‹ç»“æ„ï¼ˆä¼ªä»£ç ï¼‰
from langgraph.graph import StateGraph

# å®šä¹‰ä¸¤ä¸ªAgentï¼šPlanner + Executor
planner = ...
executor = ...

workflow = StateGraph()
workflow.add_node("plan", planner)
workflow.add_node("execute", executor)
workflow.add_edge("plan", "execute")

graph = workflow.compile()
result = graph.invoke("è§„åˆ’ä¸€æ¬¡ä¸Šæµ·3æ—¥æ¸¸å¹¶ä¼°ç®—é¢„ç®—")
```

ğŸ‘‰ **è¦ç‚¹**ï¼š  
- Planner è´Ÿè´£æ‹†è§£ä»»åŠ¡  
- Executor è´Ÿè´£æ‰§è¡Œ  
- è¿™ç§æ¨¡å¼é€‚åˆ **ä¼ä¸šçº§æµç¨‹ç¼–æ’**  

---

## 7. é¢è¯•å¸¸è§åŠ åˆ†ç‚¹
- **å¦‚ä½•å‡å°‘æ¨¡å‹å¹»è§‰ï¼Ÿ**  
ğŸ‘‰ ç”¨ RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ï¼Œé™åˆ¶æ¨¡å‹åœ¨çŸ¥è¯†åº“èŒƒå›´å†…å›ç­”ã€‚  
- **å¦‚ä½•ä¿è¯è¾“å‡ºå¯é ï¼Ÿ**  
ğŸ‘‰ ç”¨ `OutputParser` æˆ– Function Callingï¼Œç¡®ä¿ç»“æ„åŒ–è¾“å‡ºã€‚  
- **Agent é€‚åˆå“ªäº›åœºæ™¯ï¼Ÿ**  
ğŸ‘‰ å¤šå·¥å…·è°ƒç”¨ã€å¤šæ­¥éª¤ä»»åŠ¡ï¼ˆé‡‘èé£æ§ã€æ™ºèƒ½å®¢æœã€åŠå…¬è‡ªåŠ¨åŒ–ï¼‰ã€‚  

---

# ğŸ¯ æ€»ç»“ï¼ˆèƒŒè¯µé‡ç‚¹ï¼‰
1. **Agent = LLM + Tools + Memory + Executor**  
2. å¸¸è§ç±»å‹ï¼šZeroShotAgentã€ConversationalAgentã€ReActAgentã€Plan&ExecuteAgent  
3. æ ¸å¿ƒæµç¨‹ï¼šReason â†’ Act â†’ Observe â†’ Final Answer  
4. Tools æ˜¯ Agent çš„æ‰‹è‡‚ï¼ŒMemory ä¿è¯å¯¹è¯è¿è´¯ï¼ŒRAG è§£å†³çŸ¥è¯†ä¸è¶³  
5. ä¼ä¸šçº§åº”ç”¨ï¼šå¤š Agent åä½œï¼ˆLangGraphï¼‰ã€å®‰å…¨æ€§ä¸æƒé™æ§åˆ¶  

