# 同步和异步的区别?

------

### **1. 定义**

- **同步 (Synchronous)**
  - 程序按顺序执行，一个任务没完成之前，下一个任务必须等待。
  - 常见于普通函数调用。
- **异步 (Asynchronous)**
  - 任务可以在等待某些操作（如 I/O）时“挂起”，而不阻塞整个程序。
  - 其他任务可以继续执行，等等待的任务完成后再恢复执行。

------

### **2. Python 中的实现**

- **同步**

  ```python
  def task():
      print("Start")
      time.sleep(2)   # 阻塞 2 秒
      print("End")
  
  task()
  ```

  - 这会严格顺序执行，遇到 `sleep` 会卡住整个线程。

- **异步**

  ```python
  import asyncio
  
  async def task():
      print("Start")
      await asyncio.sleep(2)  # 非阻塞等待
      print("End")
  
  asyncio.run(task())
  ```

  - `await asyncio.sleep(2)` 并不会卡住整个线程，而是把控制权交还给事件循环，让别的协程先执行。

------

### **3. 关键区别**

| 特性         | 同步               | 异步（async/await）                    |
| ------------ | ------------------ | -------------------------------------- |
| 执行方式     | 顺序执行           | 可以挂起等待，切换到其他任务           |
| 效率         | I/O 密集时容易阻塞 | I/O 密集时效率高，CPU 利用更充分       |
| 适用场景     | 计算密集型任务     | I/O 密集型任务（网络请求、文件操作等） |
| Python关键字 | 无特殊语法         | `async` / `await`                      |



异步代码展示

异步版本（并发执行）

```python
import asyncio

async def task(name, delay):
    print(f"{name} start")
    await asyncio.sleep(delay)   # 非阻塞等待
    print(f"{name} end")

async def main():
    start = asyncio.get_event_loop().time()
    
    # 同时调度两个任务
    await asyncio.gather(
        task("Task A", 2),
        task("Task B", 2)
    )
    
    end = asyncio.get_event_loop().time()
    print(f"Total time: {end - start:.2f}s")

asyncio.run(main())
```



# Pydantic基本使用

、具体来说：

- `class Delivery(BaseModel):` 继承自 `pydantic.BaseModel`，这是 Pydantic 用于数据验证和解析的基类。
- 字段类型注解如 `timestamp: datetime` 和 `dimensions: tuple[int, int]` 是 Python 3.9+ 的类型注解，但 Pydantic 会根据这些注解自动进行类型转换和校验。
- 你可以直接传入字符串和列表，Pydantic 会自动转换为 `datetime` 和 `tuple[int, int]`。

标准 Python 的类不会自动做这些类型转换和校验，只有 Pydantic 的 `BaseModel` 才有这个功能。





```python
from datetime import datetime
from pydantic import BaseModel, ValidationError

class Delivery(BaseModel):
    timestamp: datetime
    dimensions: tuple[int, int]

try:
    m = Delivery(timestamp='2020-01-02T03:04:05Z', dimensions=['10', '20'])
    print(repr(m.timestamp))
    # > datetime.datetime(2020, 1, 2, 3, 4, 5, tzinfo=TzInfo(UTC))
    print(m.timestamp)
    # > 2020-01-02 03:04:05+00:00
    print(m.dimensions)
    # > (10, 20)
except ValidationError as e:
    print("Validation error:", e)

"""
datetime.datetime(2020, 1, 2, 3, 4, 5, tzinfo=TzInfo(UTC))
2020-01-02 03:04:05+00:00
(10, 20)
"""


try:
    Delivery(timestamp='2020-01-02T03:04:05Z', dimensions=['10'])
except ValidationError as e:
    print("Validation error:", e)

"""
Validation error: 1 validation error for Delivery
dimensions.1
  Field required [type=missing, input_value=['10'], input_type=list]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
"""
```

